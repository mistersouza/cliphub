"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[170],{390:(e,s,l)=>{l.d(s,{A:()=>i});var t=l(720),a=l(804),r=l(579);const i=e=>{let{message:s,noClips:l,noComments:i}=e;return(0,r.jsxs)("div",{className:" flex flex-col justify-center items-center text-gray-800 gap-1  w-full h-full ",children:[l&&(0,r.jsx)(t.DBO,{className:"text-8xl"}),i&&(0,r.jsx)(a.r4w,{className:"text-7xl"}),(0,r.jsx)("p",{className:"text-sm text-gray-500",children:s})]})}},170:(e,s,l)=>{l.r(s),l.d(s,{default:()=>b});var t=l(43),a=l(216),r=l(213),i=l(833),n=l(720),c=l(184),o=l(462),d=l(538),x=l(2),m=l(698),u=l(540),g=l(55),p=l(579);const h=e=>{let{dropdownMenuRef:s,isDropdownMenuDisplayed:l,isOwner:a,id:r,handleDelete:i}=e;const[n,c]=(0,t.useState)([]);return(0,t.useEffect)((()=>{(async()=>{try{const{data:e}=await g.y.get("flag/reasons/");c(e.reasons)}catch(e){console.log("Error fetching reasons",e)}})()}),[]),(0,p.jsx)("div",{className:`z-10 ${l?"absolute right-0 top-9":"hidden"} \n        bg-white divide-y divide-gray-100 rounded shadow w-32`,id:"dropdownDivider",ref:s,"aria-label":a?"Manage your clip":"Select flag reason",children:(0,p.jsx)("ul",{className:"py-2 text-sm text-gray-700 capitalize dark:text-gray-200","aria-labelledby":"dropdownDividerButton",children:a?(0,p.jsx)("li",{className:" flex w-full justify-between items-center px-3 py-2  hover:bg-gray-100 dark:hover:bg-gray-600           ",onClick:i,children:"delete"}):(0,p.jsx)(p.Fragment,{children:n.map((e=>(0,p.jsx)("li",{className:" flex w-full justify-between items-center px-3 py-2  hover:bg-gray-100 dark:hover:bg-gray-600           ",onClick:()=>{(async e=>{try{await g.y.post(`flag/clip/${r}/`,{reason:e})}catch(s){console.log("Failed flagging clip",s)}})(e)},children:e},e)))})})})};var f=l(390),y=l(580),j=l(400);const b=()=>{const{user:e,setClips:s}=(0,t.useContext)(y.B),[l,b]=(0,t.useState)({}),[v,N]=(0,t.useState)(!1),[w,k]=(0,t.useState)(!1),[_,C]=(0,t.useState)(!1),[S,D]=(0,t.useState)(""),[E,A]=(0,t.useState)(!1),[M,$]=(0,t.useState)(!1),[P,B]=(0,j._F)(),G=(0,j.W3)((()=>{P&&B()})),z=(0,a.Zp)(),F=(0,t.useRef)(null),[O,L]=(0,t.useState)({results:[]}),{id:R}=(0,a.g)();(0,t.useEffect)((()=>{(async()=>{try{const{data:e}=await g.G.get(`clips/${R}`);b(e),$(Boolean(e.like_id))}catch(e){console.error(e)}})()}),[R]);const{comments_count:T,profile_id:Z,profile_image:q,likes_count:U,like_id:I,views_count:V,owner:W,caption:Y}=l;(0,t.useEffect)((()=>{(async()=>{try{const{data:e}=await g.G.get(`comments/?clip=${R}`);L(e)}catch(e){console.error(e)}finally{A(!1)}})()}),[R]);const H=(null===e||void 0===e?void 0:e.username)===W,J=async()=>{if(null===F||void 0===F||F.current[v?"pause":"play"](),N((e=>!e)),!v&&!w)try{await r.A.post(`clips/${R}/play/`),b((e=>({...e,views_count:e.views_count+1}))),k(!0)}catch(e){console.log("Error incrementing views",e)}};return(0,t.useEffect)((()=>{null!==F&&void 0!==F&&F.current&&(F.current.muted=_)}),[_]),l?(0,p.jsxs)("div",{className:"fixed inset-0 bg-gray-50 flex flex-col lg:flex-row  lg:flex-nowrap",children:[(0,p.jsxs)("div",{className:"relative w-full h-1/2 lg:w-9/12 lg:h-full flex  justify-center items-center bg-gray-800 backdrop-blur-sm",children:[(0,p.jsx)("div",{className:"opacity-90 absolute top-6 left-2 lg:left-6 flex  cursor-pointer z-50",children:(0,p.jsx)(n.qiG,{className:"text-gray-500 text-3xl hover:opacity-90",onClick:()=>z(-1)})}),(0,p.jsxs)("div",{className:"relative",children:[(0,p.jsx)("div",{className:"h-[60vh] lg:h-[100vh]",children:(0,p.jsx)("video",{ref:F,className:"h-full cursor-pointer",onClick:J,src:l.clip,"aria-hidden":"true",preload:"auto"})}),(0,p.jsxs)("div",{className:"absolute top-[30%] md:top-28 lg:top-36 right-3 cursor-pointer",children:[H?(0,p.jsx)(x.Pwf,{className:"text-white font-bold text-2xl md:text-3xl","aria-label":"Dropdown menu",onMouseEnter:B}):(0,p.jsx)(x.If4,{className:"text-white font-bold text-2xl md:text-3xl","aria-label":"Flag clip",onMouseEnter:B}),(0,p.jsx)(h,{dropdownMenuRef:G,id:R,isDropdownMenuDisplayed:P,isOwner:H,handleDelete:async()=>{try{const{status:e}=await g.G.delete(`clips/${R}/`);204===e&&z(-1)}catch(e){console.log("Error deleting clip",e)}}})]}),(0,p.jsx)("div",{className:"absolute top-[45%] left-[40%] cursor-pointer",children:(0,p.jsx)("button",{"aria-label":v?"Pause":"Play",onClick:J,children:v?(0,p.jsx)(o.Amb,{className:"text-gray-200 text-6xl lg:text-8xl","aria-hidden":"true"}):(0,p.jsx)(o.i8P,{className:"text-gray-200 text-6xl lg:text-8xl","aria-hidden":"true"})})})]}),(0,p.jsx)("div",{className:"absolute bottom-5 right-5 cursor-pointer lg:bottom-3 lg:right-5",children:(0,p.jsx)("button",{onClick:()=>C((e=>!e)),"aria-label":_?"Unmute":"Mute",children:_?(0,p.jsx)(d.Zq1,{className:"text-gray-200 text-2xl lg:text-4xl"}):(0,p.jsx)(d.lST,{className:"text-gray-200 text-2xl lg:text-4xl"})})})]}),(0,p.jsxs)("div",{className:"relative flex flex-col h-1/2 w-full lg:w-3/12 lg:h-full",children:[(0,p.jsxs)("div",{className:"min-h-fit flex flex-col py-3 gap-2 md:gap-5",children:[(0,p.jsxs)("div",{className:"flex items-center gap-3 px-3",children:[(0,p.jsx)(u.A,{id:Z,src:q}),(0,p.jsxs)("div",{className:"flex flex-col",children:[(0,p.jsxs)("p",{className:"flex items-center gap-1.5",children:[(0,p.jsx)("span",{className:"text-sm text-gray-800 capitalize font-semibold",children:W}),(0,p.jsx)(i.Psn,{})]}),(0,p.jsxs)("p",{className:"text-sm text-gray-500",children:[W,"_user"]})]})]}),(0,p.jsx)("p",{className:"text-sm text-gray-700 md:text-lg px-3.5",children:Y}),(0,p.jsxs)("div",{className:"flex gap-5 items-center justify-center text-gray-700  text-sm py-1 md:py-3 md:mt-auto md:text-lg",children:[(0,p.jsxs)("div",{className:"flex flex-col gap-1 items-center",children:[(0,p.jsx)("button",{className:"bg-gray-200 rounded-full p-1 md:p-2","aria-label":M?"Unlike this clip":"Like this clip",onClick:M?async()=>{try{await g.y.delete(`likes/${I}/`),s((e=>({...e,results:e.results.map((e=>e.id===R?{...e,likes_count:e.likes_count-1,like_id:null}:e))}))),b((e=>({...e,likes_count:e.likes_count-1}))),$(!1)}catch(e){console.error(e)}}:async()=>{try{const{data:e}=await g.y.post("likes/",{clip:R});s((s=>({...s,results:s.results.map((s=>s.id===R?{...s,likes_count:s.likes_count+1,like_id:e.id}:s))}))),b((s=>({...s,likes_count:s.likes_count+1,like_id:e.id}))),$(!0)}catch(e){console.error(e)}},disabled:H,children:(0,p.jsx)(n.OGi,{className:M?"":"text-gray-400"})}),(0,p.jsx)("p",{className:"text-xs",children:U||0})]}),(0,p.jsxs)("div",{className:"flex flex-col gap-1 items-center",children:[(0,p.jsx)("div",{className:"bg-gray-200 rounded-full p-1 md:p-2 "+(T?"":"text-gray-400"),role:"img","aria-hidden":"true",children:(0,p.jsx)(c.hYw,{})}),(0,p.jsxs)("p",{className:"text-xs",children:[(0,p.jsx)("span",{className:"sr-only",children:"Comments count: "}),T||0]})]}),(0,p.jsxs)("div",{className:"flex flex-col gap-1 items-center",children:[(0,p.jsx)("div",{className:"bg-gray-200 rounded-full p-1 md:p-2 "+(V?"":"text-gray-400"),role:"img","aria-hidden":"true",children:(0,p.jsx)(m.ZT8,{})}),(0,p.jsxs)("p",{className:"text-xs",children:[(0,p.jsx)("span",{className:"sr-only",children:"Views count: "}),V||0]})]})]})]}),(0,p.jsx)("div",{className:"flex-1 overflow-y-auto flex flex-col border-t-2  border-gray-200 bg-gray-100 lg:pb-0 pb-[100px]",children:O.results.length?O.results.map((e=>(0,p.jsxs)("div",{className:"flex items-center gap-1.5 px-3 py-1.5",children:[(0,p.jsx)(u.A,{src:e.profile_image,id:e.profile_id}),(0,p.jsx)("p",{className:"text-sm font-light md:text-base lg:text-lg text-gray-800",children:e.content})]},e.id))):(0,p.jsx)(f.A,{message:""+(e?"Be the first to leave a comment":"Log in and be the first to leave a comment"),noComments:!0})}),(0,p.jsx)("div",{className:"w-full max-h-15 self-end",children:(0,p.jsx)("div",{className:"w-full p-3 border-t-2 border-gray-200",children:(0,p.jsxs)("form",{className:"flex gap-2.5",onSubmit:async e=>{e.preventDefault();try{const{data:e}=await g.y.post("comments/",{content:S,clip:R});A(!0),L((s=>({...s,results:[e,...s.results]}))),b((e=>({...e,comments_count:e.comments_count+1}))),D("")}catch(s){console.error(s)}finally{A(!1)}},children:[(0,p.jsx)("input",{className:"w-full bg-gray-100 rounded-md p-2 focus:ring-0 focus:outline-none",value:S,onChange:e=>{let{target:s}=e;return D(s.value)},placeholder:(e?"Add":"Log in to")+" comment..."}),e&&(0,p.jsx)("button",{className:`bg-gray-100 text-gray-${S.trim()?"700":"200"} rounded-lg p-2`,disabled:!S.trim(),type:"submit",children:E?(0,p.jsxs)("div",{className:"flex space-x-0.5 justify-center",children:[(0,p.jsx)("span",{className:"sr-only",children:"Posting..."}),(0,p.jsx)("div",{className:"w-2.5 h-2.5 bg-gray-500 rounded-full  animate-bounce [animation-delay:-0.3s]"}),(0,p.jsx)("div",{className:"w-2.5 h-2.5 bg-gray-500 rounded-full  animate-bounce [animation-delay:-0.15s]"}),(0,p.jsx)("div",{className:"w-2.5 h-2.5 bg-gray-500 rounded-full  animate-bounce"})]}):(0,p.jsx)("p",{children:"Post"})})]})})})]})]}):(0,p.jsx)(f.A,{message:"This clip is no longer available :/"})}}}]);
//# sourceMappingURL=170.d6bf79b2.chunk.js.map